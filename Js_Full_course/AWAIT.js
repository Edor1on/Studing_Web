// ==========================================
// –¢–ï–ú–ê: –ê–°–ò–ù–•–†–û–ù–ù–Ü–°–¢–¨ (PROMISE & ASYNC/AWAIT)
// ==========================================

// –í Node.js –æ–ø–µ—Ä–∞—Ü—ñ—ó (—á–∏—Ç–∞–Ω–Ω—è —Ñ–∞–π–ª—É, –∑–∞–ø–∏—Ç –¥–æ –ë–î) –Ω–µ –±–ª–æ–∫—É—é—Ç—å –∫–æ–¥.
// –í–æ–Ω–∏ "–æ–±—ñ—Ü—è—é—Ç—å" –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—ñ–∑–Ω—ñ—à–µ.

// ==========================================
// 1. –°–¢–í–û–†–ï–ù–ù–Ø –ü–†–û–ú–Ü–°–ê (PROMISE)
// ==========================================
// Promise ‚Äî —Ü–µ –æ–±'—î–∫—Ç, —è–∫–∏–π –º–æ–∂–µ –±—É—Ç–∏ –≤ 3 —Å—Ç–∞–Ω–∞—Ö:
// - Pending (–æ—á—ñ–∫—É–≤–∞–Ω–Ω—è)
// - Resolved (—É—Å–ø—ñ—Ö)
// - Rejected (–ø–æ–º–∏–ª–∫–∞)

// –Ü–º—ñ—Ç–∞—Ü—ñ—è –∑–∞–ø–∏—Ç—É –¥–æ –ë–∞–∑–∏ –î–∞–Ω–∏—Ö
const getUserFromDB = (id) => {
    return new Promise((resolve, reject) => {
        console.log(`‚è≥ (–ë–∞–∑–∞) –®—É–∫–∞—é —é–∑–µ—Ä–∞ –∑ ID: ${id}...`);

        setTimeout(() => {
            if (id > 0) {
                // –£—Å–ø—ñ—Ö: –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –¥–∞–Ω—ñ
                resolve({ id: id, name: "Adrian", role: "Admin" });
            } else {
                // –ü–æ–º–∏–ª–∫–∞: –≤—ñ–¥—Ö–∏–ª—è—î–º–æ –∑–∞–ø–∏—Ç
                reject("‚ùå –ü–æ–º–∏–ª–∫–∞: –ù–µ–≤—ñ—Ä–Ω–∏–π ID!");
            }
        }, 2000); // –ó–∞—Ç—Ä–∏–º–∫–∞ 2 —Å–µ–∫—É–Ω–¥–∏
    });
};

// ==========================================
// 2. –°–¢–ê–†–ò–ô –ü–Ü–î–•–Ü–î (.then / .catch)
// ==========================================
// –†–∞–Ω—ñ—à–µ –ø–∏—Å–∞–ª–∏ —Ç–∞–∫. –¢–∏ –º–∞—î—à —Ü–µ –∑–Ω–∞—Ç–∏, —â–æ–± —á–∏—Ç–∞—Ç–∏ —Å—Ç–∞—Ä–∏–π –∫–æ–¥,
// –∞–ª–µ –Ω–∞ —Å–ø—ñ–≤–±–µ—Å—ñ–¥—ñ –ø–∏—à–∏ –Ω–æ–≤–∏–º —Å–ø–æ—Å–æ–±–æ–º (–ø—É–Ω–∫—Ç 3).

/*
console.log("1. –ü–æ—á–∞—Ç–æ–∫");

getUserFromDB(1)
    .then((user) => {
        console.log("2. –Æ–∑–µ—Ä–∞ –æ—Ç—Ä–∏–º–∞–Ω–æ:", user);
        return user.role; // –ú–æ–∂–Ω–∞ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ –¥–∞–Ω—ñ –¥–∞–ª—ñ –ª–∞–Ω—Ü—é–∂–∫–æ–º
    })
    .then((role) => {
        console.log("3. –†–æ–ª—å —é–∑–µ—Ä–∞:", role);
    })
    .catch((error) => {
        console.error(error); // –°—é–¥–∏ –≤–ø–∞–¥–µ, —è–∫—â–æ –±—É–≤ reject
    })
    .finally(() => {
        console.log("4. –ö—ñ–Ω–µ—Ü—å –æ–ø–µ—Ä–∞—Ü—ñ—ó");
    });
*/

// ==========================================
// 3. –°–£–ß–ê–°–ù–ò–ô –ü–Ü–î–•–Ü–î (ASYNC / AWAIT) - ‚òÖ MUST KNOW ‚òÖ
// ==========================================
// –¶–µ "—Ü—É–∫–æ—Ä". –ü—Ä–∞—Ü—é—î 1:1 —è–∫ –≤ C#.
// –ö–æ–¥ –≤–∏–≥–ª—è–¥–∞—î —è–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π, –∞–ª–µ –Ω–µ –±–ª–æ–∫—É—î –ø–æ—Ç—ñ–∫.

const startServer = async () => {
    console.log("üöÄ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è...");

    try {
        // AWAIT: "–°—Ç—ñ–π —Ç—É—Ç —ñ —á–µ–∫–∞–π, –ø–æ–∫–∏ –ø—Ä–æ–º—ñ—Å –Ω–µ –≤–∏–∫–æ–Ω–∞—î—Ç—å—Å—è"
        // –†–µ–∑—É–ª—å—Ç–∞—Ç –∑ resolve() –∑–∞–ø–∏—à–µ—Ç—å—Å—è —É –∑–º—ñ–Ω–Ω—É user.
        const user = await getUserFromDB(1);
        console.log(`‚úÖ –ü—Ä–∏–≤—ñ—Ç, ${user.name}!`);

        // –ú–æ–∂–Ω–∞ —Ä–æ–±–∏—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞–ø–∏—Ç, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –¥–∞–Ω—ñ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ
        // (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —à—É–∫–∞—î–º–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —Ü—å–æ–≥–æ —é–∑–µ—Ä–∞)
        // const orders = await getOrders(user.id);

    } catch (error) {
        // –Ø–∫—â–æ –ø—Ä–æ–º—ñ—Å –∑—Ä–æ–±–∏–≤ reject(), –º–∏ –ø–æ—Ç—Ä–∞–ø–∏–º–æ —Å—é–¥–∏
        // –¶–µ –∞–Ω–∞–ª–æ–≥ try-catch –≤ C#
        console.error("üö® –°—Ç–∞–ª–∞—Å—è –±—ñ–¥–∞:", error);
    }

    console.log("üèÅ –°–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤–∏–π –ø—Ä–∏–π–º–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏.");
};

// –ó–∞–ø—É—Å–∫–∞—î–º–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é
startServer();


// ==========================================
// 4. –ü–ê–†–ê–õ–ï–õ–¨–ù–ï –í–ò–ö–û–ù–ê–ù–ù–Ø (Promise.all)
// ==========================================
// –Ø–∫—â–æ —Ç—Ä–µ–±–∞ –∑—Ä–æ–±–∏—Ç–∏ 3 –∑–∞–ø–∏—Ç–∏ –æ–¥–Ω–æ—á–∞—Å–Ω–æ (–Ω–µ —á–µ–∫–∞—é—á–∏ –æ–¥–∏–Ω –æ–¥–Ω–æ–≥–æ).
// –í C# —Ü–µ Task.WhenAll()

const loadDashboard = async () => {
    try {
        // –ó–∞–ø—É—Å–∫–∞—î–º–æ –≤—Å—ñ –∑–∞–ø–∏—Ç–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ
        const [user, stats, news] = await Promise.all([
            getUserFromDB(1),       // 2 —Å–µ–∫
            getUserFromDB(2),       // 2 —Å–µ–∫
            getUserFromDB(3)        // 2 —Å–µ–∫
        ]);
        // –ó–∞–≥–∞–ª—å–Ω–∏–π —á–∞—Å: 2 —Å–µ–∫ (–∞ –Ω–µ 6), –±–æ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ.

        console.log("–í—Å—ñ –¥–∞–Ω—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!", user, stats, news);

    } catch (err) {
        console.log("–•–æ—á–∞ –± –æ–¥–∏–Ω –∑–∞–ø–∏—Ç –≤–ø–∞–≤, –≤—Å–µ —Å–∫–∞—Å–æ–≤–∞–Ω–æ.");
    }
};

// loadDashboard();