// ==========================================
// 1. ПІДГОТОВКА ДАНИХ
// ==========================================

// Масив, з яким ми будемо працювати весь урок.
// Це список користувачів з полями: ім'я, вік, стать.
const users = [
    { name: "Vitaly", age: 26, sex: "male" },
    { name: "Jessica", age: 17, sex: "female" },
    { name: "Robert", age: 16, sex: "male" },
    { name: "Sarah", age: 20, sex: "female" },
    { name: "Rob", age: 34, sex: "male" }
];

// ==========================================
// 2. МЕТОД forEach
// ==========================================
// Використовується для перебору масиву. Нічого не повертає (undefined).
// Аналог циклу for...of, але більш читабельний.

// ЗАДАЧА: Порахувати кількість чоловіків та жінок.

const count = { men: 0, women: 0 };

users.forEach((user) => {
    // Ця функція запускається для КОЖНОГО елемента масиву
    if (user.sex === 'male') {
        count.men++;
    } else {
        count.women++;
    }
});

console.log(count); // { men: 3, women: 2 }


// ==========================================
// 3. МЕТОД filter [ДУЖЕ ВАЖЛИВИЙ]
// ==========================================
// Створює НОВИЙ масив, в який потрапляють тільки ті елементи,
// які пройшли перевірку (функція повернула true).

// ЗАДАЧА: Відібрати користувачів, яким є 18 років (для "дорослого контенту").

const adults = users.filter((user) => {
    // Якщо умова true, елемент потрапляє в новий масив 'adults'
    return user.age >= 18; 
});

console.log(adults); 
// Результат: масив з 3 об'єктів (Vitaly, Sarah, Rob). 
// Jessica (17) та Robert (16) відфільтровані.


// ==========================================
// 4. МЕТОД map [ДУЖЕ ВАЖЛИВИЙ]
// ==========================================
// Створює НОВИЙ масив такої ж довжини, але кожен елемент
// може бути змінений (трансформований).

// ЗАДАЧА: Створити список імен з приставками Mr. або Mrs.

const formalNames = users.map((user) => {
    // Перевіряємо стать і формуємо новий рядок

    return user.sex === 'male' 
        ? `Mr. ${user.name}` 
        : `Mrs. ${user.name}`;
});

console.log(formalNames);
// Результат: ['Mr. Vitaly', 'Mrs. Jessica', 'Mr. Robert', 'Mrs. Sarah', 'Mr. Rob']


// ==========================================
// 5. МЕТОД reduce [СКЛАДНИЙ, АЛЕ ВАЖЛИВИЙ]
// ==========================================
// Використовується, щоб обчислити єдине значення на основі всього масиву
// (наприклад, суму, середнє арифметичне).

// ЗАДАЧА: Знайти середній вік аудиторії.

// accumulator - це "скарбничка", яка накопичує результат з кожною ітерацією.
// 0 (другий аргумент) - це початкове значення акумулятора.
const totalAge = users.reduce((accumulator, user) => {
    return accumulator + user.age;
}, 0);

// Рахуємо середнє: загальна сума / кількість людей
const averageAge = totalAge / users.length;

console.log(totalAge);   // 113
console.log(averageAge); // 22.6


// ==========================================
// 6. МЕТОД find
// ==========================================
// Знаходить ПЕРШИЙ елемент, який задовольняє умову, і повертає його.
// Якщо не знайдено - повертає undefined.

// ЗАДАЧА: Знайти користувача з ім'ям "Rob".

const rob = users.find((user) => user.name === "Rob");

console.log(rob); // { name: "Rob", age: 34, sex: "male" }


// ==========================================
// 7. МЕТОДИ some ТА every (ПЕРЕВІРКИ)
// ==========================================
// Повертають true або false.

// some - перевіряє, чи ХОЧА Б ОДИН елемент відповідає умові.
const hasAdults = users.some((user) => user.age > 18);
console.log(hasAdults); // true (бо є люди старші 18)

// every - перевіряє, чи ВСІ елементи відповідають умові.
const allAdults = users.every((user) => user.age > 18);
console.log(allAdults); // false (бо є Джессіка та Роберт, яким менше 18)


// ==========================================
// 8. МЕТОД findIndex
// ==========================================
// Працює як find, але повертає не сам елемент, а його ІНДЕКС (номер).
// Якщо не знайдено - повертає -1.

// ЗАДАЧА: Дізнатися порядковий номер Роба в масиві.

const robIndex = users.findIndex((user) => user.name === "Rob");

console.log(robIndex); // 4 (бо він п'ятий у списку, рахунок з нуля)